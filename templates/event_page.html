<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>{{ event.name }} | ××™×¨×•×¢</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='common_styles.css') }}">
    <style>
        .event-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; }
        .event-title { font-size: 2rem; font-weight: bold; margin: 0 0 15px 0; }
        .event-meta { display: flex; gap: 30px; flex-wrap: wrap; font-size: 0.95rem; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e6e9ef; }
        .tab { 
            padding: 14px 28px; 
            cursor: pointer; 
            background: none; 
            border: none; 
            font-size: 1.1rem; 
            font-family: 'Heebo', sans-serif;
            font-weight: 600;
            color: #666; 
            border-bottom: 3px solid transparent; 
            transition: all 0.3s ease;
            letter-spacing: 0.3px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab-icon {
            width: 18px;
            height: 18px;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            flex-shrink: 0;
        }
        .tab:hover { 
            color: var(--primary); 
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px 8px 0 0;
        }
        .tab.active { 
            color: var(--primary); 
            border-bottom-color: var(--primary); 
            font-weight: 700;
            background: rgba(102, 126, 234, 0.08);
            border-radius: 8px 8px 0 0;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .btn { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; text-decoration: none; display: inline-block; font-family: 'Heebo', sans-serif; }
        .btn:hover { opacity: 0.9; }
        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-secondary { background: #6c757d; }
        .btn-small { padding: 6px 12px; font-size: 0.85rem; }
        input, textarea, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: 'Heebo', sans-serif; box-sizing: border-box; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: right; border-bottom: 1px solid #eee; }
        th { background: #043841; font-weight: bold; color: white; }
        tr:hover { background: #f8fafc; }
        .checklist-item { display: flex; align-items: center; gap: 10px; padding: 10px; border-bottom: 1px solid #eee; }
        .checklist-item input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; }
        .checklist-item span { color: #333 !important; }
        .checklist-item span.completed { text-decoration: line-through; color: #999 !important; }
        .equipment-item { display: flex; align-items: center; gap: 10px; padding: 10px; border-bottom: 1px solid #eee; }
        .equipment-item input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; }
        .equipment-item span { color: #333 !important; }
        .payment-badge { padding: 5px 10px; border-radius: 15px; font-size: 0.85rem; font-weight: bold; }
        .payment-pending { background: #fff3cd; color: #856404; }
        .payment-deposit { background: #cfe2ff; color: #084298; }
        .payment-full { background: #d1e7dd; color: #0f5132; }
        .modal { display: none; position: fixed; z-index: 10000; right: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
        .modal-content { background: white; margin: 50px auto; padding: 30px; border-radius: 12px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .close { font-size: 2rem; cursor: pointer; }
        .inline-form { display: flex; gap: 10px; align-items: flex-end; margin-bottom: 15px; }
        .inline-form .form-group { flex: 1; margin-bottom: 0; }
        .phone-link { color: var(--success); text-decoration: none; font-weight: bold; }
        .phone-link:hover { text-decoration: underline; }
        
        /* Graphics Table Styles */
        .graphics-table-container { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .graphics-toolbar { display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; align-items: center; }
        .graphics-search { flex: 1; min-width: 200px; padding: 10px 15px; border: 2px solid #e6e9ef; border-radius: 8px; font-family: 'Heebo', sans-serif; background: white; color: #292f4c; }
        .graphics-table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; }
        .graphics-table th { background: #043841; padding: 12px; text-align: right; font-weight: 700; color: white; border-bottom: 2px solid #e6e9ef; position: sticky; top: 0; z-index: 10; }
        .graphics-table td { padding: 10px 12px; border-bottom: 1px solid #e6e9ef; color: #292f4c; background: white; }
        .graphics-table tr { transition: background 0.2s; background: white; }
        .graphics-table tr:hover { background: #f8fafc; }
        .graphics-table tr:hover td { background: #f8fafc; }
        .graphics-table tr.arrived { background: #d1e7dd !important; }
        .graphics-table tr.arrived td { background: #d1e7dd !important; color: #0f5132; font-weight: 500; }
        .graphics-table tr.status-pending { background: #fff3cd !important; }
        .graphics-table tr.status-pending td { background: #fff3cd !important; color: #856404; }
        .graphics-table tr.status-in-progress { background: #cfe2ff !important; }
        .graphics-table tr.status-in-progress td { background: #cfe2ff !important; color: #084298; }
        .graphics-table tr.status-approved { background: #d4edda !important; }
        .graphics-table tr.status-approved td { background: #d4edda !important; color: #155724; }
        .graphics-table tr.status-production { background: #f8d7da !important; }
        .graphics-table tr.status-production td { background: #f8d7da !important; color: #721c24; }
        .graphics-table input, .graphics-table textarea, .graphics-table select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-family: 'Heebo', sans-serif; font-size: 0.95rem; box-sizing: border-box; background: white; color: #292f4c; }
        .graphics-table input:focus, .graphics-table textarea:focus, .graphics-table select:focus { outline: none; border-color: #0073ea; box-shadow: 0 0 0 2px rgba(0,115,234,0.1); background: white; }
        .graphics-table textarea { resize: vertical; min-height: 60px; background: white; color: #292f4c; }
        .graphics-table .editable-cell { cursor: pointer; padding: 8px; border-radius: 4px; transition: background 0.2s; color: #292f4c; }
        .graphics-table .editable-cell:hover { background: #e9ecef !important; }
        .graphics-table .editable-cell.editing { background: white !important; padding: 0; }
        .graphics-table .delete-btn { background: #d66b74; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-size: 0.85rem; }
        .graphics-table .delete-btn:hover { background: #c55a65; }
        .graphics-table .quantity-input { width: 80px; text-align: center; background: white; color: #292f4c; }
        .graphics-table .checkbox-cell { text-align: center; background: inherit; }
        .graphics-table input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; }
        .graphics-table select { background: white; color: #292f4c; }
        
        /* Management Table Styles */
        .management-table-container { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .management-toolbar { display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; align-items: center; }
        .management-table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; }
        .management-table th { background: #043841; padding: 12px; text-align: right; font-weight: 700; color: white; border-bottom: 2px solid #e6e9ef; position: sticky; top: 0; z-index: 10; }
        .management-table td { padding: 10px 12px; border-bottom: 1px solid #e6e9ef; color: #292f4c; background: white; }
        .management-table tr { transition: background 0.2s; }
        .management-table tr:hover { background: #f8fafc; }
        .management-table tr.day-header { background: #e9ecef !important; font-weight: bold; color: #043841; }
        .management-table tr.day-header td { background: #e9ecef !important; font-size: 1.1rem; padding: 15px; }
        .management-table tr.category-meal { background: #fff3cd !important; }
        .management-table tr.category-prayer { background: #d1ecf1 !important; }
        .management-table tr.category-activity { background: #d4edda !important; }
        .management-table tr.category-logistics { background: #f8d7da !important; }
        .management-table input, .management-table textarea, .management-table select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-family: 'Heebo', sans-serif; font-size: 0.95rem; box-sizing: border-box; background: white; color: #292f4c; }
        .management-table input:focus, .management-table textarea:focus, .management-table select:focus { outline: none; border-color: #0073ea; box-shadow: 0 0 0 2px rgba(0,115,234,0.1); }
        .management-table .editable-cell { cursor: pointer; padding: 8px; border-radius: 4px; transition: background 0.2s; }
        .management-table .editable-cell:hover { background: #e9ecef !important; }
        .management-table .editable-cell.editing { background: white !important; padding: 0; }
        .management-table input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; }
        .management-table .cost-toggle { cursor: pointer; color: #0073ea; text-decoration: underline; font-size: 0.85rem; }
        .management-table .cost-row { display: none; background: #f8fafc; }
        .management-table .cost-row.show { display: table-row; }
        .management-table .cost-row td { padding: 8px 12px; font-size: 0.9rem; }
        
        /* Shopping List Styles */
        .shopping-table-container { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .shopping-table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; }
        .shopping-table th { background: #043841; padding: 12px; text-align: right; font-weight: 700; color: white; border-bottom: 2px solid #e6e9ef; }
        .shopping-table td { padding: 10px 12px; border-bottom: 1px solid #e6e9ef; color: #292f4c; background: white; }
        .shopping-table tr:hover { background: #f8fafc; }
        .shopping-table input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="sidebar">
        <a href="/" class="sidebar-logo"><img src="{{ url_for('static', filename='Vatkin_Logo.jpg') }}"></a>
        <a href="/" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
            ×“×©×‘×•×¨×“
        </a>
        <div class="nav-item">
            <a href="/all_clients" class="nav-link active">
                <svg class="nav-icon" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                ×œ×•×— ×œ×§×•×—×•×ª
            </a>
            <div class="users-dropdown">
                {% for uid, info in sidebar_users.items() %}
                <a href="/all_clients?user={{ uid }}" class="user-sub-link">â€¢ {{ info.name }}</a>
                {% endfor %}
            </div>
        </div>
        <a href="/finance" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
            ×›×¡×¤×™×
        </a>
        <a href="/events" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            ××™×¨×•×¢×™×
        </a>
        <a href="/suppliers" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
            ×¡×¤×§×™×
        </a>
        <a href="/quotes" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
            ×”×¦×¢×•×ª ××—×™×¨
        </a>
        <a href="/forms" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg>
            ×˜×¤×¡×™×
        </a>
        <a href="/admin/dashboard" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
            ×“×•×— ×× ×”×œ×™×
        </a>
        {% if current_user.id == 'admin' %}
        <a href="/admin/users" class="nav-link active">
            <svg class="nav-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path></svg>
            × ×™×”×•×œ ×¦×•×•×ª
        </a>
        {% endif %}
        <div class="sidebar-user-area">
            <div class="sidebar-user-name">{{ current_user.name }}</div>
            <a href="/logout" class="sidebar-logout-link">
                <svg class="nav-icon" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                ×”×ª× ×ª×§
            </a>
        </div>
    </div>
    
    <div class="container">
        <div class="event-header">
            <h1 class="event-title">{{ event.name }}</h1>
            <div class="event-meta">
                <span><strong>×œ×§×•×—:</strong> {{ event.client.name if event.client else '×œ× ×¦×•×™×Ÿ' }}</span>
                <span><strong>×¡×•×’:</strong> {{ event.event_type }}</span>
                {% if event.date %}<span><strong>×ª××¨×™×š:</strong> {{ event.date }}</span>{% endif %}
                {% if event.location %}<span><strong>××™×§×•×:</strong> {{ event.location }}</span>{% endif %}
            </div>
            
            <!-- ×¨×™×‘×•×¢×™ ×ª×§×¦×™×‘ -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 30px;">
                <!-- ×¨×™×‘×•×¢ 1: × ×™×”×•×œ ×ª×§×¦×™×‘ -->
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; backdrop-filter: blur(10px);">
                    <h3 style="margin: 0 0 10px 0; font-size: 1.2rem; font-weight: bold;">× ×™×”×•×œ ×ª×§×¦×™×‘</h3>
                    <div style="font-size: 1.8rem; font-weight: bold;">
                        â‚ª{{ "{:,.0f}".format(total_budget) }}
                    </div>
                </div>
                
                <!-- ×¨×™×‘×•×¢ 2: ×”×•×¦××•×ª -->
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; backdrop-filter: blur(10px);">
                    <h3 style="margin: 0 0 10px 0; font-size: 1.2rem; font-weight: bold;">×”×•×¦××•×ª</h3>
                    <div style="font-size: 1.8rem; font-weight: bold;">
                        â‚ª{{ "{:,.0f}".format(total_expenses) }}
                    </div>
                </div>
                
                <!-- ×¨×™×‘×•×¢ 3: ×©×•×¨×ª ×¨×•×•×— -->
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 8px; backdrop-filter: blur(10px);">
                    <h3 style="margin: 0 0 10px 0; font-size: 1.2rem; font-weight: bold;">×©×•×¨×ª ×¨×•×•×—</h3>
                    <div style="font-size: 1.8rem; font-weight: bold;">
                        â‚ª{{ "{:,.0f}".format(profit_margin) }}
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 15px;">
                <a href="/events" class="btn btn-secondary">â† ×—×–×¨×” ×œ××™×¨×•×¢×™×</a>
            </div>
        </div>

        <!-- ×›×¨×˜×™×¡×™×•×ª -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('details', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                ×¤×¨×˜×™×
            </button>
            <button class="tab" onclick="showTab('checklist', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                ×¦'×§-×œ×™×¡×˜
            </button>
            <button class="tab" onclick="showTab('suppliers', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                ×¡×¤×§×™×
            </button>
            <button class="tab" onclick="showTab('equipment', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
                ×¦×™×•×“
            </button>
            <button class="tab" onclick="showTab('charges', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                ×—×™×•×‘×™×
            </button>
            <button class="tab" onclick="showTab('graphics', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line><line x1="2" y1="12" x2="22" y2="12"></line><line x1="2" y1="7" x2="7" y2="7"></line><line x1="2" y1="17" x2="7" y2="17"></line><line x1="17" y1="17" x2="22" y2="17"></line><line x1="17" y1="7" x2="22" y2="7"></line></svg>
                ×˜×‘×œ×ª ×’×¨×¤×™×§×”
            </button>
            <button class="tab" onclick="showTab('management', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
                ×˜×‘×œ×ª × ×™×”×•×œ
            </button>
            <button class="tab" onclick="showTab('shopping', this)">
                <svg class="tab-icon" viewBox="0 0 24 24"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                ×§× ×™×•×ª
            </button>
        </div>

        <!-- ×›×¨×˜×™×¡×™×™×ª ×¤×¨×˜×™× -->
        <div id="details" class="tab-content active">
            <div class="card">
                <h2>×¤×¨×˜×™ ×”××™×¨×•×¢</h2>
                <form method="POST" action="/update_event/{{ event.id }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <div class="form-group">
                        <label>×©× ×”××™×¨×•×¢</label>
                        <input type="text" name="name" value="{{ event.name }}" required>
                    </div>
                    <div class="form-group">
                        <label>×œ×§×•×—</label>
                        <select name="client_id" required>
                            {% for client in clients %}
                            <option value="{{ client.id }}" {% if event.client_id == client.id %}selected{% endif %}>{{ client.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>×¡×•×’ ××™×¨×•×¢</label>
                        <select name="event_type" required>
                            <option value="×›× ×¡" {% if event.event_type == '×›× ×¡' %}selected{% endif %}>×›× ×¡</option>
                            <option value="×—×ª×•× ×”" {% if event.event_type == '×—×ª×•× ×”' %}selected{% endif %}>×—×ª×•× ×”</option>
                            <option value="×”×©×§×”" {% if event.event_type == '×”×©×§×”' %}selected{% endif %}>×”×©×§×”</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>×ª××¨×™×š ×”××™×¨×•×¢</label>
                        <input type="date" name="date" value="{{ event.date }}" required>
                    </div>
                    <div class="form-group">
                        <label>××™×§×•×</label>
                        <input type="text" name="location" value="{{ event.location or '' }}">
                    </div>
                    <div class="form-group">
                        <label>×”×¢×¨×•×ª</label>
                        <textarea name="notes" rows="4">{{ event.notes or '' }}</textarea>
                    </div>
                    <button type="submit" class="btn">×©××•×¨ ×©×™× ×•×™×™×</button>
                </form>
            </div>
        </div>

        <!-- ×›×¨×˜×™×¡×™×™×ª ×¦'×§-×œ×™×¡×˜ -->
        <div id="checklist" class="tab-content">
            <div class="card">
                <h2>×¦'×§-×œ×™×¡×˜</h2>
                <form method="POST" action="/add_checklist_item/{{ event.id }}" style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="text" name="new_item" placeholder="×”×•×¡×£ ××©×™××” ×—×“×©×”..." style="flex: 1;" required>
                    <button type="submit" class="btn btn-success">×”×•×¡×£</button>
                </form>
                <div id="checklistContainer">
                    {% if event.checklist %}
                    {% for item in event.checklist %}
                    <div class="checklist-item" style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 10px; flex: 1;">
                            <input type="checkbox" 
                                   {% if item.completed %}checked{% endif %}
                                   onchange="updateChecklist({{ loop.index0 }}, this.checked)">
                            <span class="{% if item.completed %}completed{% endif %}" style="color: #333;">
                                {{ item.task }}
                            </span>
                        </div>
                        <form action="/remove_checklist_item/{{ event.id }}/{{ loop.index0 }}" method="POST" style="display: inline;" onsubmit="return confirm('×”×× ×œ××—×•×§ ××©×™××” ×–×•?');">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                            <button type="submit" class="btn btn-danger btn-small">××—×§</button>
                        </form>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div style="text-align: center; color: #999; padding: 30px;">××™×Ÿ ××©×™××•×ª ×‘×¦'×§-×œ×™×¡×˜</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- ×›×¨×˜×™×¡×™×™×ª ×¡×¤×§×™× -->
        <div id="suppliers" class="tab-content">
            <div class="card">
                <h2>× ×™×”×•×œ ×¡×¤×§×™×</h2>
                <button onclick="openAddSupplierModal()" class="btn btn-small" style="background: #28a745; color: white;">+ ×”×•×¡×£ ×¡×¤×§ ×œ××™×¨×•×¢</button>
                
                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>×©× ×¡×¤×§</th>
                            <th>×˜×œ×¤×•×Ÿ</th>
                            <th>×ª×—×•×</th>
                            <th>××—×™×¨</th>
                            <th>×¡×˜×˜×•×¡ ×ª×©×œ×•×</th>
                            <th>×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for supplier in event.suppliers %}
                        <tr>
                            <td>{{ supplier.name }}</td>
                            <td>
                                <a href="tel:{{ supplier.phone }}" class="phone-link">{{ supplier.phone }}</a>
                                <a href="https://wa.me/972{{ supplier.phone[1:] if supplier.phone.startswith('0') else supplier.phone }}" target="_blank" class="btn btn-small btn-success" style="margin-right: 10px; padding: 4px 8px;">ğŸ“±</a>
                            </td>
                            <td>{{ supplier.category }}</td>
                            <td>â‚ª{{ "{:,.0f}".format(supplier.price) }}</td>
                            <td>
                                <span class="payment-badge 
                                    {% if supplier.payment_status == 'pending' %}payment-pending
                                    {% elif supplier.payment_status == 'deposit_paid' %}payment-deposit
                                    {% elif supplier.payment_status == 'fully_paid' %}payment-full{% endif %}">
                                    {% if supplier.payment_status == 'pending' %}×××ª×™×Ÿ ×œ×ª×©×œ×•×
                                    {% elif supplier.payment_status == 'deposit_paid' %}×©×•×œ××” ××§×“××”
                                    {% elif supplier.payment_status == 'fully_paid' %}×©×•×œ× ×¡×•×¤×™×ª{% endif %}
                                </span>
                            </td>
                            <td>
                                <form action="/remove_event_supplier/{{ event.id }}/{{ loop.index0 }}" method="POST" style="display: inline;" onsubmit="return confirm('×”×× ×œ×”×¡×™×¨ ×¡×¤×§ ×–×”?');">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                    <button type="submit" class="btn btn-danger btn-small">××—×§</button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                        {% if not event.suppliers %}
                        <tr><td colspan="6" style="text-align: center; color: #999; padding: 30px;">××™×Ÿ ×¡×¤×§×™× ××©×•×™×›×™× ×œ××™×¨×•×¢</td></tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ×›×¨×˜×™×¡×™×™×ª ×¦×™×•×“ -->
        <div id="equipment" class="tab-content">
            <div class="card">
                <h2>××—×¡×Ÿ ×¦×™×•×“</h2>
                <div style="margin-bottom: 20px;">
                    <form method="POST" action="/add_equipment_to_bank" style="display: flex; gap: 10px;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <input type="text" name="equipment_name" placeholder="×”×•×¡×£ ×¤×¨×™×˜ ×—×“×© ×œ×××’×¨..." style="flex: 1;" required>
                        <button type="submit" class="btn btn-success btn-small">×”×•×¡×£ ×œ×××’×¨</button>
                    </form>
                </div>
                <div style="margin-bottom: 20px;">
                    <button onclick="exportSelectedEquipment()" class="btn btn-small" style="background: #28a745; color: white;">ğŸ“Š ×™×™×¦× ×œ××§×¡×œ - ×¤×¨×™×˜×™× ××¡×•×× ×™×</button>
                </div>
                <div id="equipmentContainer">
                    {% if equipment_bank %}
                    {% for item in equipment_bank %}
                    <div class="equipment-item">
                        <input type="checkbox" 
                               {% if event.equipment and item in event.equipment %}checked{% endif %}
                               onchange="updateEquipment('{{ item }}', this.checked)">
                        <span>{{ item }}</span>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div style="text-align: center; color: #999; padding: 30px;">××™×Ÿ ×¤×¨×™×˜×™× ×‘×××’×¨ ×”×¦×™×•×“</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- ×›×¨×˜×™×¡×™×™×ª ×—×™×•×‘×™× -->
        <div id="charges" class="tab-content">
            <div class="card">
                <h2 style="color: #292f4c;">× ×™×”×•×œ ×—×™×•×‘×™×</h2>
                <form method="POST" action="/add_event_charge/{{ event.id }}" class="inline-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <div class="form-group">
                        <label style="color: #292f4c;">×›×•×ª×¨×ª ×—×™×•×‘</label>
                        <input type="text" name="title" required style="color: #292f4c;">
                    </div>
                    <div class="form-group">
                        <label style="color: #292f4c;">×¡×›×•× ×œ×—×™×•×‘</label>
                        <input type="number" name="amount" step="0.01" required style="color: #292f4c;">
                    </div>
                    <div class="form-group">
                        <label style="color: #292f4c;">×¢×œ×•×ª ×©×œ× ×•</label>
                        <input type="number" name="our_cost" step="0.01" value="0" style="color: #292f4c;">
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn" style="background: #28a745; color: white;">×”×•×¡×£ ×—×™×•×‘</button>
                    </div>
                </form>
                
                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th style="color: #292f4c;">×ª××¨×™×š</th>
                            <th style="color: #292f4c;">×›×•×ª×¨×ª</th>
                            <th style="color: #292f4c;">×¡×›×•× ×œ×—×™×•×‘</th>
                            <th style="color: #292f4c;">×¢×œ×•×ª ×©×œ× ×•</th>
                            <th style="color: #292f4c; text-align: center;">×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for charge in event.charges %}
                        <tr>
                            <td style="color: #292f4c;">{{ charge.date }}</td>
                            <td style="color: #292f4c;">
                                {{ charge.title }}
                                {% if charge.get('charge_number') %}
                                <span style="color: #94a3b8; font-size: 0.75rem; font-weight: normal; margin-right: 8px; font-family: 'Heebo', monospace;">#{{ charge.charge_number }}</span>
                                {% endif %}
                            </td>
                            <td style="color: #292f4c;">â‚ª{{ "{:,.0f}".format(charge.amount) }}</td>
                            <td style="color: #292f4c;">â‚ª{{ "{:,.0f}".format(charge.get('our_cost', 0)) }}</td>
                            <td style="text-align: center;">
                                <button onclick="editCharge(this)" 
                                        class="btn btn-small edit-charge-btn" 
                                        style="background: #ffc107; color: #000; padding: 6px 12px; margin-left: 5px;"
                                        data-charge-id="{{ charge.id }}"
                                        data-title="{{ charge.title }}"
                                        data-amount="{{ charge.amount }}"
                                        data-our-cost="{{ charge.get('our_cost', 0) }}">×¢×¨×•×š</button>
                            </td>
                        </tr>
                        {% endfor %}
                        {% if not event.charges or event.charges|length == 0 %}
                        <tr><td colspan="5" style="text-align: center; color: #999; padding: 30px;">××™×Ÿ ×—×™×•×‘×™× ×œ××™×¨×•×¢ ×–×”</td></tr>
                        {% else %}
                        <tr style="background: #f8fafc; font-weight: bold;">
                            <td colspan="2" style="color: #292f4c;">×¡×”"×›</td>
                            <td style="color: #292f4c;">â‚ª{{ "{:,.0f}".format(total_budget) }}</td>
                            <td style="color: #292f4c;">â‚ª{{ "{:,.0f}".format(total_expenses) }}</td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal ×œ×”×•×¡×¤×ª ×¡×¤×§ -->
    <div id="supplierModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>×”×•×¡×£ ×¡×¤×§ ×œ××™×¨×•×¢</h2>
                <span class="close" onclick="closeSupplierModal()">&times;</span>
            </div>
            <form method="POST" action="/add_event_supplier/{{ event.id }}" id="addSupplierForm">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <div class="form-group">
                    <label>×‘×—×¨ ×¡×¤×§ ×§×™×™× ××• ×¦×•×¨ ×—×“×©</label>
                    <select name="supplier_id" id="supplierSelect" onchange="toggleSupplierFields()">
                        <option value="">-- ×‘×—×¨ ×¡×¤×§ ×§×™×™× --</option>
                        <option value="__NEW__">+ ×¦×•×¨ ×¡×¤×§ ×—×“×©</option>
                        {% for supplier in suppliers_list %}
                        <option value="{{ supplier.id }}">{{ supplier.name }} ({{ supplier.category }})</option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- ×©×“×•×ª ×œ×¡×¤×§ ×—×“×© (××•×¡×ª×¨×™× ×‘×ª×—×™×œ×”) -->
                <div id="newSupplierFields" style="display: none; background: #f8fafc; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                    <div class="form-group">
                        <label>×©× ×”×¡×¤×§ *</label>
                        <input type="text" name="new_supplier_name" id="newSupplierName">
                    </div>
                    <div class="form-group">
                        <label>×˜×œ×¤×•×Ÿ *</label>
                        <input type="text" name="new_supplier_phone" id="newSupplierPhone">
                    </div>
                    <div class="form-group">
                        <label>××™××™×™×œ</label>
                        <input type="email" name="new_supplier_email" id="newSupplierEmail">
                    </div>
                    <div class="form-group">
                        <label>×¡×•×’ ×”×¡×¤×§</label>
                        <input type="text" name="new_supplier_type" id="newSupplierType">
                    </div>
                    <div class="form-group">
                        <label>×ª×—×•× *</label>
                        <input type="text" name="new_supplier_category" id="newSupplierCategory">
                    </div>
                    <div class="form-group">
                        <label>×”×¢×¨×•×ª</label>
                        <textarea name="new_supplier_notes" id="newSupplierNotes" rows="2"></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label>××—×™×¨</label>
                    <input type="number" name="price" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>×¡×˜×˜×•×¡ ×ª×©×œ×•×</label>
                    <select name="payment_status">
                        <option value="pending">×××ª×™×Ÿ ×œ×ª×©×œ×•×</option>
                        <option value="deposit_paid">×©×•×œ××” ××§×“××”</option>
                        <option value="fully_paid">×©×•×œ× ×¡×•×¤×™×ª</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>×”×¢×¨×•×ª</label>
                    <textarea name="notes" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="closeSupplierModal()" class="btn btn-secondary">×‘×™×˜×•×œ</button>
                    <button type="submit" class="btn">×”×•×¡×£</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const eventId = '{{ event.id }}';
        const initialChecklist = {{ event.checklist | tojson | safe }};
        const initialEquipment = {{ (event.equipment or []) | tojson | safe }};
        const initialGraphics = {{ (event.graphics_items or []) | tojson | safe }};
        
        function showTab(tabName, buttonElement) {
            // ×”×¡×ª×¨ ×›×œ ×”×›×¨×˜×™×¡×™×•×ª
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ×”×¦×’ ××ª ×”×›×¨×˜×™×¡×™×” ×”× ×‘×—×¨×ª
            document.getElementById(tabName).classList.add('active');
            if (buttonElement) {
                buttonElement.classList.add('active');
            }
            
            // ×˜×¢×Ÿ ××ª ×˜×‘×œ×ª ×”×’×¨×¤×™×§×” ×× ×–×” ×”×œ×©×•× ×™×ª ×©×œ ×’×¨×¤×™×§×”
            if (tabName === 'graphics') {
                GraphicsManager.init();
            }
        }
        
        function updateChecklist(index, completed) {
            const updatedChecklist = initialChecklist.map((item, i) => {
                if (i === index) {
                    return {...item, completed: completed};
                }
                return item;
            });
            
            fetch('/update_event_checklist/' + eventId, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ checklist: updatedChecklist })
            }).then(response => response.json()).then(data => {
                if (data.success) {
                    // ×¢×“×›×Ÿ ××ª ×”×××©×§
                    initialChecklist[index].completed = completed;
                    const item = document.querySelectorAll('.checklist-item')[index];
                    const span = item.querySelector('span');
                    if (completed) {
                        span.classList.add('completed');
                        span.style.textDecoration = 'line-through';
                        span.style.color = '#999';
                    } else {
                        span.classList.remove('completed');
                        span.style.textDecoration = 'none';
                        span.style.color = '#333';
                    }
                }
            });
        }
        
        function updateEquipment(itemName, checked) {
            let newEquipment;
            if (checked) {
                if (initialEquipment.indexOf(itemName) === -1) {
                    newEquipment = initialEquipment.concat([itemName]);
                } else {
                    newEquipment = initialEquipment;
                }
            } else {
                newEquipment = initialEquipment.filter(item => item !== itemName);
            }
            
            fetch('/update_event_equipment/' + eventId, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ equipment: newEquipment })
            }).then(response => response.json()).then(data => {
                if (data.success) {
                    // ×¢×“×›×Ÿ ××ª ×”××¢×¨×š ×”××§×•××™
                    if (checked) {
                        if (initialEquipment.indexOf(itemName) === -1) {
                            initialEquipment.push(itemName);
                        }
                    } else {
                        const index = initialEquipment.indexOf(itemName);
                        if (index > -1) {
                            initialEquipment.splice(index, 1);
                        }
                    }
                } else {
                    console.error('Error updating equipment:', data.error);
                }
            });
        }
        
        function openAddSupplierModal() {
            document.getElementById('supplierModal').style.display = 'block';
            // ××™×¤×•×¡ ×”×˜×•×¤×¡
            document.getElementById('supplierSelect').value = '';
            toggleSupplierFields();
        }
        
        function closeSupplierModal() {
            document.getElementById('supplierModal').style.display = 'none';
        }
        
        function toggleSupplierFields() {
            const select = document.getElementById('supplierSelect');
            const newFields = document.getElementById('newSupplierFields');
            if (select && select.value === '__NEW__') {
                newFields.style.display = 'block';
                // ×”×¤×•×š ×©×“×•×ª ×—×•×‘×”
                document.getElementById('newSupplierName').required = true;
                document.getElementById('newSupplierPhone').required = true;
                document.getElementById('newSupplierCategory').required = true;
                // ×‘×˜×œ ××ª ×”×—×•×‘×” ×¢×œ select
                select.removeAttribute('required');
            } else if (select && newFields) {
                newFields.style.display = 'none';
                // ×‘×˜×œ ×—×•×‘×” ××©×“×•×ª ×—×“×©×™×
                const nameField = document.getElementById('newSupplierName');
                const phoneField = document.getElementById('newSupplierPhone');
                const categoryField = document.getElementById('newSupplierCategory');
                if (nameField) nameField.required = false;
                if (phoneField) phoneField.required = false;
                if (categoryField) categoryField.required = false;
                // ×”×—×–×¨ ×—×•×‘×” ×œ-select
                select.setAttribute('required', 'required');
            }
        }
        
        function exportSelectedEquipment() {
            const checkboxes = document.querySelectorAll('#equipmentContainer input[type="checkbox"]:checked');
            const selectedItems = [];
            checkboxes.forEach(cb => {
                const itemName = cb.parentElement.querySelector('span').textContent;
                selectedItems.push(itemName);
            });
            
            if (selectedItems.length === 0) {
                alert('×× × ×‘×—×¨ ×œ×¤×—×•×ª ×¤×¨×™×˜ ××—×“ ×œ×™×™×¦×•×');
                return;
            }
            
            // ×™×¦×™×¨×ª URL ×¢× ×”×¤×¨×™×˜×™× ×”××¡×•×× ×™×
            const eventId = '{{ event.id }}';
            const itemsParam = encodeURIComponent(JSON.stringify(selectedItems));
            window.location.href = `/export_event_equipment/${eventId}?items=${itemsParam}`;
        }
        
        window.onclick = function(event) {
            const modal = document.getElementById('supplierModal');
            if (event.target == modal) {
                closeSupplierModal();
            }
            const editModal = document.getElementById('editChargeModal');
            if (event.target == editModal) {
                closeEditChargeModal();
            }
        }
        
        function editCharge(button) {
            const chargeId = button.getAttribute('data-charge-id');
            const title = button.getAttribute('data-title');
            const amount = button.getAttribute('data-amount');
            const ourCost = button.getAttribute('data-our-cost') || '0';
            
            document.getElementById('editChargeId').value = chargeId;
            document.getElementById('editChargeTitle').value = title;
            document.getElementById('editChargeAmount').value = amount;
            document.getElementById('editChargeOurCost').value = ourCost;
            document.getElementById('editChargeModal').style.display = 'block';
        }
        
        function closeEditChargeModal() {
            document.getElementById('editChargeModal').style.display = 'none';
        }
        
        // Graphics Manager
        const GraphicsManager = {
            items: [],
            
            init() {
                // ×˜×¢×Ÿ ××ª ×”×¤×¨×™×˜×™× ××”×©×¨×ª ××• ××”××©×ª× ×” ×”×’×œ×•×‘×œ×™
                this.items = initialGraphics.length > 0 ? initialGraphics : [];
                this.renderTable();
            },
            
            renderTable() {
                const tbody = document.getElementById('graphicsTableBody');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                
                if (this.items.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">××™×Ÿ ×¤×¨×™×˜×™× ×’×¨×¤×™×™×. ×œ×—×¥ ×¢×œ "×”×•×¡×£ ×¤×¨×™×˜ ×’×¨×¤×™" ×œ×”×ª×—×œ×”.</td></tr>';
                    return;
                }
                
                this.items.forEach((item, index) => {
                    const row = this.createRow(item, index);
                    tbody.appendChild(row);
                });
            },
            
            createRow(item, index) {
                const tr = document.createElement('tr');
                tr.className = this.getRowClass(item);
                tr.setAttribute('data-index', index);
                
                // ×©× ×”×¤×¨×™×˜
                const nameCell = document.createElement('td');
                nameCell.className = 'editable-cell';
                nameCell.textContent = item.name || '';
                nameCell.onclick = () => this.editCell(nameCell, 'name', index, 'text');
                tr.appendChild(nameCell);
                
                // ××™×“×•×ª
                const dimensionsCell = document.createElement('td');
                dimensionsCell.className = 'editable-cell';
                dimensionsCell.textContent = item.dimensions || '';
                dimensionsCell.onclick = () => this.editCell(dimensionsCell, 'dimensions', index, 'text');
                tr.appendChild(dimensionsCell);
                
                // ×›××•×ª
                const quantityCell = document.createElement('td');
                quantityCell.style.textAlign = 'center';
                const quantityInput = document.createElement('input');
                quantityInput.type = 'number';
                quantityInput.className = 'quantity-input';
                quantityInput.value = item.quantity || 1;
                quantityInput.min = '1';
                quantityInput.onchange = () => this.updateField(index, 'quantity', parseInt(quantityInput.value) || 1);
                quantityCell.appendChild(quantityInput);
                tr.appendChild(quantityCell);
                
                // ×”×¢×¨×•×ª ×œ×¡×˜×•×“×™×•
                const notesCell = document.createElement('td');
                notesCell.className = 'editable-cell';
                notesCell.textContent = item.studio_notes || '';
                notesCell.style.maxWidth = '300px';
                notesCell.onclick = () => this.editCell(notesCell, 'studio_notes', index, 'textarea');
                tr.appendChild(notesCell);
                
                // ×¡×˜×˜×•×¡
                const statusCell = document.createElement('td');
                const statusSelect = document.createElement('select');
                const statuses = ['×××ª×™×Ÿ', '×‘×¢×™×¦×•×‘', '××•×©×¨ ×œ×”×“×¤×¡×”', '×‘×™×™×¦×•×¨', '×”×’×™×¢ ×œ××™×¨×•×¢'];
                statuses.forEach(status => {
                    const option = document.createElement('option');
                    option.value = status;
                    option.textContent = status;
                    if (item.status === status) option.selected = true;
                    statusSelect.appendChild(option);
                });
                statusSelect.onchange = () => {
                    this.updateField(index, 'status', statusSelect.value);
                    tr.className = this.getRowClass({...item, status: statusSelect.value});
                };
                statusCell.appendChild(statusSelect);
                tr.appendChild(statusCell);
                
                // ×”×’×™×¢?
                const arrivedCell = document.createElement('td');
                arrivedCell.className = 'checkbox-cell';
                const arrivedCheckbox = document.createElement('input');
                arrivedCheckbox.type = 'checkbox';
                arrivedCheckbox.checked = item.arrived || false;
                arrivedCheckbox.onchange = () => {
                    this.updateField(index, 'arrived', arrivedCheckbox.checked);
                    tr.className = this.getRowClass({...item, arrived: arrivedCheckbox.checked});
                };
                arrivedCell.appendChild(arrivedCheckbox);
                tr.appendChild(arrivedCell);
                
                // ×›×¤×ª×•×¨ ××—×§
                const actionsCell = document.createElement('td');
                actionsCell.style.textAlign = 'center';
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn';
                deleteBtn.textContent = 'ğŸ—‘ï¸';
                deleteBtn.onclick = () => this.deleteItem(index);
                actionsCell.appendChild(deleteBtn);
                tr.appendChild(actionsCell);
                
                return tr;
            },
            
            getRowClass(item) {
                if (item.arrived) return 'arrived';
                const statusMap = {
                    '×××ª×™×Ÿ': 'status-pending',
                    '×‘×¢×™×¦×•×‘': 'status-in-progress',
                    '××•×©×¨ ×œ×”×“×¤×¡×”': 'status-approved',
                    '×‘×™×™×¦×•×¨': 'status-production'
                };
                return statusMap[item.status] || '';
            },
            
            editCell(cell, field, index, type) {
                const currentValue = cell.textContent.trim();
                cell.classList.add('editing');
                
                let input;
                if (type === 'textarea') {
                    input = document.createElement('textarea');
                    input.style.minHeight = '80px';
                } else {
                    input = document.createElement('input');
                    input.type = 'text';
                }
                input.value = currentValue;
                input.style.width = '100%';
                
                cell.innerHTML = '';
                cell.appendChild(input);
                input.focus();
                input.select();
                
                const save = () => {
                    const newValue = input.value.trim();
                    cell.classList.remove('editing');
                    cell.textContent = newValue;
                    this.updateField(index, field, newValue);
                };
                
                input.onblur = save;
                input.onkeydown = (e) => {
                    if (e.key === 'Enter' && type !== 'textarea') {
                        e.preventDefault();
                        save();
                    } else if (e.key === 'Escape') {
                        cell.classList.remove('editing');
                        cell.textContent = currentValue;
                    }
                };
            },
            
            updateField(index, field, value) {
                if (!this.items[index]) return;
                
                this.items[index][field] = value;
                this.saveToServer();
            },
            
            async saveToServer() {
                try {
                    const response = await fetch(`/update_event_graphics/${eventId}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ graphics_items: this.items })
                    });
                    
                    const data = await response.json();
                    if (!data.success) {
                        console.error('Error saving graphics:', data.error);
                    }
                } catch (error) {
                    console.error('Error saving graphics:', error);
                }
            },
            
            addItem() {
                const newItem = {
                    id: Date.now().toString(),
                    name: '',
                    dimensions: '',
                    quantity: 1,
                    studio_notes: '',
                    status: '×××ª×™×Ÿ',
                    arrived: false
                };
                
                this.items.push(newItem);
                this.renderTable();
                
                // ×¡×’×•×¨ ×œ×¢×¨×™×›×” ×¢×œ ×©× ×”×¤×¨×™×˜ ×”×—×“×©
                setTimeout(() => {
                    const lastRow = document.querySelector(`#graphicsTableBody tr[data-index="${this.items.length - 1}"]`);
                    if (lastRow) {
                        const nameCell = lastRow.querySelector('td.editable-cell');
                        if (nameCell) nameCell.click();
                    }
                }, 100);
            },
            
            deleteItem(index) {
                if (!confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×¤×¨×™×˜?')) return;
                
                this.items.splice(index, 1);
                this.renderTable();
                this.saveToServer();
            },
            
            filterTable() {
                const searchTerm = document.getElementById('graphicsSearch').value.toLowerCase();
                const statusFilter = document.getElementById('graphicsStatusFilter').value;
                
                const rows = document.querySelectorAll('#graphicsTableBody tr');
                rows.forEach(row => {
                    const index = parseInt(row.getAttribute('data-index'));
                    if (isNaN(index)) return;
                    
                    const item = this.items[index];
                    if (!item) return;
                    
                    const matchesSearch = !searchTerm || (item.name || '').toLowerCase().includes(searchTerm);
                    const matchesStatus = !statusFilter || item.status === statusFilter;
                    
                    row.style.display = (matchesSearch && matchesStatus) ? '' : 'none';
                });
            },
            
            async exportToExcel() {
                try {
                    const response = await fetch(`/export_event_graphics/${eventId}`, {
                        method: 'GET'
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `graphics_${eventId}_${new Date().getTime()}.xlsx`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                    } else {
                        alert('×©×’×™××” ×‘×™×™×¦×•× ×œ×§×•×‘×¥ Excel');
                    }
                } catch (error) {
                    console.error('Error exporting to Excel:', error);
                    alert('×©×’×™××” ×‘×™×™×¦×•× ×œ×§×•×‘×¥ Excel');
                }
            }
        };
    </script>
    
    <script>
        // Management Table Manager
        const ManagementTable = {
            data: {{ (event.management_table or []) | tojson | safe }},
            currentDay: null,
            
            init() {
                this.render();
            },
            
            render() {
                const tbody = document.getElementById('managementTableBody');
                if (!tbody) return;
                tbody.innerHTML = '';
                
                if (this.data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="9" style="text-align: center; padding: 30px; color: #999;">××™×Ÿ × ×ª×•× ×™×. ×œ×—×¥ ×¢×œ "×”×•×¡×£ ×©×•×¨×”" ×›×“×™ ×œ×”×ª×—×™×œ</td></tr>';
                    return;
                }
                
                this.data.forEach((row, index) => {
                    if (row.type === 'day-header') {
                        const tr = document.createElement('tr');
                        tr.className = 'day-header';
                        tr.innerHTML = `<td colspan="9">${row.day}</td>`;
                        tbody.appendChild(tr);
                    } else {
                        this.renderRow(row, index);
                    }
                });
            },
            
            renderRow(row, index) {
                const tbody = document.getElementById('managementTableBody');
                const tr = document.createElement('tr');
                tr.className = `category-${row.category || 'activity'}`;
                tr.dataset.index = index;
                
                tr.innerHTML = `
                    <td><input type="time" value="${row.time || ''}" onchange="ManagementTable.updateField(${index}, 'time', this.value)" style="border: none; background: transparent; width: 100%;"></td>
                    <td><input type="text" value="${(row.activity || '').replace(/"/g, '&quot;')}" onchange="ManagementTable.updateField(${index}, 'activity', this.value)" placeholder="×¢×•× ×’ ×©×‘×ª"></td>
                    <td><input type="text" value="${(row.location || '').replace(/"/g, '&quot;')}" onchange="ManagementTable.updateField(${index}, 'location', this.value)" placeholder="×—×“×¨ ××•×›×œ"></td>
                    <td><textarea onchange="ManagementTable.updateField(${index}, 'operations', this.value)" placeholder="×ª×™××•×¨ ×‘×™×¦×•×¢×™">${(row.operations || '').replace(/"/g, '&quot;')}</textarea></td>
                    <td>
                        <input type="text" value="${(row.logistics || '').replace(/"/g, '&quot;')}" 
                               onchange="ManagementTable.updateField(${index}, 'logistics', this.value)"
                               placeholder="×¨×©×™××ª ×¤×¨×™×˜×™×"
                               onblur="ManagementTable.syncToShopping(${index}, this.value)">
                        <button onclick="ManagementTable.openLogisticsModal(${index})" class="btn btn-small" style="margin-top: 5px; padding: 4px 8px; font-size: 0.8rem;">×‘×—×¨ ××¦×™×•×“</button>
                    </td>
                    <td>
                        <select onchange="ManagementTable.updateField(${index}, 'graphics', this.value)">
                            <option value="">-- ×‘×—×¨ --</option>
                            ${this.getGraphicsOptions(row.graphics)}
                        </select>
                    </td>
                    <td style="text-align: center;">
                        <input type="checkbox" ${row.completed ? 'checked' : ''} 
                               onchange="ManagementTable.updateField(${index}, 'completed', this.checked)">
                    </td>
                    <td>
                        <span class="cost-toggle" onclick="ManagementTable.toggleCost(${index})">×¢×œ×•×™×•×ª</span>
                    </td>
                    <td style="text-align: center;">
                        <button onclick="ManagementTable.deleteRow(${index})" class="btn btn-danger btn-small">××—×§</button>
                    </td>
                `;
                tbody.appendChild(tr);
                
                // Add cost row
                const costRow = document.createElement('tr');
                costRow.className = 'cost-row';
                costRow.dataset.index = index;
                costRow.innerHTML = `
                    <td colspan="2"><strong>×ª××—×•×¨:</strong></td>
                    <td colspan="2">
                        <input type="number" value="${row.budget || 0}" step="0.01" 
                               onchange="ManagementTable.updateField(${index}, 'budget', parseFloat(this.value))"
                               placeholder="×ª××—×•×¨">
                    </td>
                    <td colspan="2"><strong>×¢×œ×•×ª:</strong></td>
                    <td colspan="3">
                        <input type="number" value="${row.cost || 0}" step="0.01" 
                               onchange="ManagementTable.updateField(${index}, 'cost', parseFloat(this.value))"
                               placeholder="×¢×œ×•×ª">
                    </td>
                `;
                tbody.appendChild(costRow);
            },
            
            getGraphicsOptions(selected) {
                const graphics = {{ (event.graphics_items or []) | tojson | safe }};
                return graphics.map(g => 
                    `<option value="${g.id || ''}" ${(g.id || '') === selected ? 'selected' : ''}>${(g.name || '×œ×œ× ×©×').replace(/"/g, '&quot;')}</option>`
                ).join('');
            },
            
            addRow() {
                this.data.push({
                    time: '',
                    activity: '',
                    location: '',
                    operations: '',
                    logistics: '',
                    graphics: '',
                    completed: false,
                    budget: 0,
                    cost: 0,
                    category: 'activity'
                });
                this.save();
                this.render();
            },
            
            addDayGroup(day) {
                this.data.push({
                    type: 'day-header',
                    day: day
                });
                this.save();
                this.render();
            },
            
            updateField(index, field, value) {
                if (this.data[index]) {
                    this.data[index][field] = value;
                    this.save();
                }
            },
            
            deleteRow(index) {
                if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ×©×•×¨×” ×–×•?')) {
                    this.data.splice(index, 1);
                    this.save();
                    this.render();
                }
            },
            
            toggleCost(index) {
                const costRow = document.querySelector(`tr.cost-row[data-index="${index}"]`);
                if (costRow) {
                    costRow.classList.toggle('show');
                }
            },
            
            syncToShopping(index, logisticsText) {
                if (!logisticsText) return;
                const items = logisticsText.split(',').map(item => item.trim()).filter(item => item);
                items.forEach(item => {
                    ShoppingList.addItemFromManagement(item);
                });
            },
            
            openLogisticsModal(index) {
                alert('×¤×•× ×§×¦×™×•× ×œ×™×•×ª ×‘×—×™×¨×ª ×¦×™×•×“ ×ª×ª×•×•×¡×£ ×‘×§×¨×•×‘');
            },
            
            async save() {
                try {
                    const response = await fetch(`/update_event_management_table/${eventId}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ management_table: this.data })
                    });
                    const result = await response.json();
                    if (!result.success) {
                        console.error('Error saving management table:', result.error);
                    }
                } catch (error) {
                    console.error('Error saving management table:', error);
                }
            },
            
            async exportToExcel() {
                try {
                    const response = await fetch(`/export_event_management/${eventId}`, {
                        method: 'GET'
                    });
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `management_${eventId}_${new Date().getTime()}.xlsx`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                    }
                } catch (error) {
                    console.error('Error exporting to Excel:', error);
                    alert('×©×’×™××” ×‘×™×™×¦×•× ×œ×§×•×‘×¥ Excel');
                }
            }
        };
        
        // Shopping List Manager
        const ShoppingList = {
            data: {{ (event.shopping_list or []) | tojson | safe }},
            
            init() {
                this.render();
            },
            
            render() {
                const tbody = document.getElementById('shoppingTableBody');
                if (!tbody) return;
                tbody.innerHTML = '';
                
                if (this.data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 30px; color: #999;">××™×Ÿ ×¤×¨×™×˜×™×. ×œ×—×¥ ×¢×œ "×”×•×¡×£ ×¤×¨×™×˜" ×›×“×™ ×œ×”×ª×—×™×œ</td></tr>';
                    return;
                }
                
                this.data.forEach((item, index) => {
                    const tr = document.createElement('tr');
                    tr.dataset.index = index;
                    tr.innerHTML = `
                        <td><input type="text" value="${(item.name || '').replace(/"/g, '&quot;')}" onchange="ShoppingList.updateField(${index}, 'name', this.value)" placeholder="×©× ×”×¤×¨×™×˜"></td>
                        <td><input type="number" value="${item.quantity || 1}" min="1" onchange="ShoppingList.updateField(${index}, 'quantity', parseInt(this.value))"></td>
                        <td>
                            <select onchange="ShoppingList.updateField(${index}, 'unit', this.value)">
                                <option value="×™×—×™×“×”" ${item.unit === '×™×—×™×“×”' ? 'selected' : ''}>×™×—×™×“×”</option>
                                <option value="×§"×’" ${item.unit === '×§"×’' ? 'selected' : ''}>×§"×’</option>
                                <option value="×œ×™×˜×¨" ${item.unit === '×œ×™×˜×¨' ? 'selected' : ''}>×œ×™×˜×¨</option>
                                <option value="×—×‘×™×œ×”" ${item.unit === '×—×‘×™×œ×”' ? 'selected' : ''}>×—×‘×™×œ×”</option>
                                <option value="×§×¨×˜×•×Ÿ" ${item.unit === '×§×¨×˜×•×Ÿ' ? 'selected' : ''}>×§×¨×˜×•×Ÿ</option>
                            </select>
                        </td>
                        <td><input type="text" value="${(item.supplier || '').replace(/"/g, '&quot;')}" onchange="ShoppingList.updateField(${index}, 'supplier', this.value)" placeholder="×©× ×¡×¤×§"></td>
                        <td><input type="number" value="${item.price || 0}" step="0.01" onchange="ShoppingList.updateField(${index}, 'price', parseFloat(this.value))" placeholder="0.00"></td>
                        <td><textarea onchange="ShoppingList.updateField(${index}, 'notes', this.value)" placeholder="×”×¢×¨×•×ª">${(item.notes || '').replace(/"/g, '&quot;')}</textarea></td>
                        <td style="text-align: center;">
                            <input type="checkbox" ${item.purchased ? 'checked' : ''} 
                                   onchange="ShoppingList.updateField(${index}, 'purchased', this.checked)">
                        </td>
                        <td style="text-align: center;">
                            <button onclick="ShoppingList.deleteItem(${index})" class="btn btn-danger btn-small">××—×§</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            },
            
            addItem() {
                this.data.push({
                    name: '',
                    quantity: 1,
                    unit: '×™×—×™×“×”',
                    supplier: '',
                    price: 0,
                    notes: '',
                    purchased: false
                });
                this.save();
                this.render();
            },
            
            addItemFromManagement(itemName) {
                const exists = this.data.find(item => item.name === itemName);
                if (!exists) {
                    this.data.push({
                        name: itemName,
                        quantity: 1,
                        unit: '×™×—×™×“×”',
                        supplier: '',
                        price: 0,
                        notes: '',
                        purchased: false
                    });
                    this.save();
                    this.render();
                }
            },
            
            updateField(index, field, value) {
                if (this.data[index]) {
                    this.data[index][field] = value;
                    this.save();
                }
            },
            
            deleteItem(index) {
                if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ×¤×¨×™×˜ ×–×”?')) {
                    this.data.splice(index, 1);
                    this.save();
                    this.render();
                }
            },
            
            async save() {
                try {
                    const response = await fetch(`/update_event_shopping_list/${eventId}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ shopping_list: this.data })
                    });
                    const result = await response.json();
                    if (!result.success) {
                        console.error('Error saving shopping list:', result.error);
                    }
                } catch (error) {
                    console.error('Error saving shopping list:', error);
                }
            },
            
            async exportToExcel() {
                try {
                    const response = await fetch(`/export_event_shopping/${eventId}`, {
                        method: 'GET'
                    });
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `shopping_${eventId}_${new Date().getTime()}.xlsx`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                    }
                } catch (error) {
                    console.error('Error exporting to Excel:', error);
                    alert('×©×’×™××” ×‘×™×™×¦×•× ×œ×§×•×‘×¥ Excel');
                }
            }
        };
        
        // Initialize when management tab is shown
        const originalShowTab = showTab;
        showTab = function(tabName, buttonElement) {
            originalShowTab(tabName, buttonElement);
            if (tabName === 'management') {
                ManagementTable.init();
            } else if (tabName === 'shopping') {
                ShoppingList.init();
            }
        };
    </script>
    
    <!-- Modal ×œ×¢×¨×™×›×ª ×—×™×•×‘ -->
    <div id="editChargeModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>×¢×¨×™×›×ª ×—×™×•×‘</h2>
                <span class="close" onclick="closeEditChargeModal()">&times;</span>
            </div>
            <form method="POST" action="/edit_event_charge/{{ event.id }}" id="editChargeForm">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <input type="hidden" name="tab" value="charges">
                <input type="hidden" name="charge_id" id="editChargeId">
                <div class="form-group">
                    <label style="color: #292f4c;">×›×•×ª×¨×ª ×—×™×•×‘</label>
                    <input type="text" name="title" id="editChargeTitle" required style="color: #292f4c;">
                </div>
                <div class="form-group">
                    <label style="color: #292f4c;">×¡×›×•× ×œ×—×™×•×‘</label>
                    <input type="number" name="amount" id="editChargeAmount" step="0.01" required style="color: #292f4c;">
                </div>
                <div class="form-group">
                    <label style="color: #292f4c;">×¢×œ×•×ª ×©×œ× ×•</label>
                    <input type="number" name="our_cost" id="editChargeOurCost" step="0.01" value="0" style="color: #292f4c;">
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" onclick="closeEditChargeModal()" class="btn btn-secondary">×‘×™×˜×•×œ</button>
                    <button type="submit" class="btn" style="background: #ffc107; color: #000;">×©××•×¨ ×©×™× ×•×™×™×</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ×›×¨×˜×™×¡×™×™×ª ×˜×‘×œ×ª ×’×¨×¤×™×§×” -->
    <div id="graphics" class="tab-content">
        <div class="graphics-table-container">
            <h2 style="color: #292f4c; margin-bottom: 25px; font-size: 1.8rem;">
                ×˜×‘×œ×ª ×’×¨×¤×™×§×”
            </h2>
            
            <!-- ×¡×¨×’×œ ×¤×¢×•×œ×•×ª -->
            <div class="graphics-toolbar">
                <button onclick="GraphicsManager.addItem()" class="btn" style="background: #28a745;">
                    + ×”×•×¡×£ ×¤×¨×™×˜ ×’×¨×¤×™
                </button>
                <button onclick="GraphicsManager.exportToExcel()" class="btn" style="background: #17a2b8;">
                    ğŸ“¥ ×™×™×¦×•× ×œ×¡×˜×•×“×™×• (Excel)
                </button>
                <input type="text" id="graphicsSearch" class="graphics-search" placeholder="ğŸ” ×—×™×¤×•×© ×œ×¤×™ ×©× ×¤×¨×™×˜..." onkeyup="GraphicsManager.filterTable()">
                <select id="graphicsStatusFilter" class="graphics-search" style="flex: 0 0 200px;" onchange="GraphicsManager.filterTable()">
                    <option value="">×›×œ ×”×¡×˜×˜×•×¡×™×</option>
                    <option value="×××ª×™×Ÿ">×××ª×™×Ÿ</option>
                    <option value="×‘×¢×™×¦×•×‘">×‘×¢×™×¦×•×‘</option>
                    <option value="××•×©×¨ ×œ×”×“×¤×¡×”">××•×©×¨ ×œ×”×“×¤×¡×”</option>
                    <option value="×‘×™×™×¦×•×¨">×‘×™×™×¦×•×¨</option>
                    <option value="×”×’×™×¢ ×œ××™×¨×•×¢">×”×’×™×¢ ×œ××™×¨×•×¢</option>
                </select>
            </div>
            
            <!-- ×˜×‘×œ×” ×“×™× ××™×ª -->
            <div style="overflow-x: auto;">
                <table class="graphics-table" id="graphicsTable">
                    <thead>
                        <tr>
                            <th style="min-width: 200px;">×©× ×”×¤×¨×™×˜</th>
                            <th style="min-width: 120px;">××™×“×•×ª</th>
                            <th style="min-width: 80px; text-align: center;">×›××•×ª</th>
                            <th style="min-width: 250px;">×”×¢×¨×•×ª ×œ×¡×˜×•×“×™×•</th>
                            <th style="min-width: 150px;">×¡×˜×˜×•×¡</th>
                            <th style="min-width: 100px; text-align: center;">×”×’×™×¢?</th>
                            <th style="min-width: 80px; text-align: center;">×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody id="graphicsTableBody">
                        <!-- ×”×©×•×¨×•×ª ×™×ª×•×•×¡×¤×• ×“×™× ××™×ª -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ×›×¨×˜×™×¡×™×™×ª ×˜×‘×œ×ª × ×™×”×•×œ -->
    <div id="management" class="tab-content">
        <div class="management-table-container">
            <h2 style="color: #292f4c; margin-bottom: 25px; font-size: 1.8rem;">
                ×˜×‘×œ×ª × ×™×”×•×œ ××™×¨×•×¢
            </h2>
            
            <!-- ×¡×¨×’×œ ×¤×¢×•×œ×•×ª -->
            <div class="management-toolbar">
                <button onclick="ManagementTable.addRow()" class="btn" style="background: #28a745;">
                    + ×”×•×¡×£ ×©×•×¨×”
                </button>
                <button onclick="ManagementTable.addDayGroup('×™×•× ×©×™×©×™')" class="btn" style="background: #17a2b8;">
                    + ×”×•×¡×£ ×™×•× ×©×™×©×™
                </button>
                <button onclick="ManagementTable.addDayGroup('×©×‘×ª')" class="btn" style="background: #17a2b8;">
                    + ×”×•×¡×£ ×©×‘×ª
                </button>
                <button onclick="ManagementTable.exportToExcel()" class="btn" style="background: #6c757d;">
                    ğŸ“¥ ×™×™×¦× ×œ××§×¡×œ
                </button>
            </div>
            
            <!-- ×˜×‘×œ×” ×“×™× ××™×ª -->
            <div style="overflow-x: auto;">
                <table class="management-table" id="managementTable">
                    <thead>
                        <tr>
                            <th style="min-width: 120px;">×–××Ÿ</th>
                            <th style="min-width: 150px;">×¤×¢×™×œ×•×ª</th>
                            <th style="min-width: 120px;">××™×§×•×</th>
                            <th style="min-width: 200px;">×”×¤×§×”</th>
                            <th style="min-width: 200px;">×¦×™×•×“/××–×•×Ÿ</th>
                            <th style="min-width: 150px;">×’×¨×¤×™×§×”</th>
                            <th style="min-width: 80px; text-align: center;">×‘×•×¦×¢</th>
                            <th style="min-width: 100px;">×¢×œ×•×™×•×ª</th>
                            <th style="min-width: 80px; text-align: center;">×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody id="managementTableBody">
                        <!-- ×”×©×•×¨×•×ª ×™×ª×•×•×¡×¤×• ×“×™× ××™×ª -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ×›×¨×˜×™×¡×™×™×ª ×§× ×™×•×ª -->
    <div id="shopping" class="tab-content">
        <div class="shopping-table-container">
            <h2 style="color: #292f4c; margin-bottom: 25px; font-size: 1.8rem;">
                ×¨×©×™××ª ×§× ×™×•×ª
            </h2>
            
            <!-- ×¡×¨×’×œ ×¤×¢×•×œ×•×ª -->
            <div class="management-toolbar">
                <button onclick="ShoppingList.addItem()" class="btn" style="background: #28a745;">
                    + ×”×•×¡×£ ×¤×¨×™×˜
                </button>
                <button onclick="ShoppingList.exportToExcel()" class="btn" style="background: #6c757d;">
                    ğŸ“¥ ×™×™×¦× ×œ××§×¡×œ
                </button>
            </div>
            
            <!-- ×˜×‘×œ×” ×“×™× ××™×ª -->
            <div style="overflow-x: auto;">
                <table class="shopping-table" id="shoppingTable">
                    <thead>
                        <tr>
                            <th style="min-width: 200px;">×¤×¨×™×˜</th>
                            <th style="min-width: 100px;">×›××•×ª</th>
                            <th style="min-width: 120px;">×™×—×™×“×ª ××™×“×”</th>
                            <th style="min-width: 150px;">×¡×¤×§</th>
                            <th style="min-width: 120px;">××—×™×¨</th>
                            <th style="min-width: 200px;">×”×¢×¨×•×ª</th>
                            <th style="min-width: 80px; text-align: center;">× ×¨×›×©</th>
                            <th style="min-width: 80px; text-align: center;">×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody id="shoppingTableBody">
                        <!-- ×”×©×•×¨×•×ª ×™×ª×•×•×¡×¤×• ×“×™× ××™×ª -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    {% include '_chat_widget.html' %}
</body>
</html>

